# Phase 1.8: DNS解決問題のまとめと代替方法

**作成日**: 2026-01-04  
**問題**: DNS解決ではIPv6アドレスのみが返され、`psql`と`pg_restore`がIPv4アドレスを探している  
**本番環境のプロジェクトID**: `snowkercpcuixnwxchkc`（確認済み）

---

## ⚠️ 現在の状況

**DNS解決の結果：**
- IPv6アドレス: `2406:da14:271:9916:8e31:ac9f:8fe7:9ef3`（取得済み）
- IPv4アドレス: 取得できませんでした

**`psql`と`pg_restore`がIPv4アドレスを探しているため、接続できません。**

**試行した方法：**
1. ✅ パスワードのURLエンコード
2. ✅ 環境変数を使用した接続
3. ✅ 正しいプロジェクトIDを使用
4. ❌ IPv6アドレスを直接使用（ネットワーク接続エラー）
5. ❌ Supabase CLIを使用（DNS解決の問題が継続）

---

## ✅ 推奨される代替方法

### 方法1: Supabase DashboardのSQL Editorを使用（最も確実）

**Supabase DashboardのSQL Editorを使用してデータをインポート：**

1. **Supabase Dashboard**にログイン
2. **プロジェクト `snowkercpcuixnwxchkc`** を選択
3. **SQL Editor**を開く
4. **バックアップファイルをSQL形式に変換**
   - `.dir.tar.gz`ファイルを展開
   - SQLファイルを抽出
   - SQL Editorで実行

**注意**: この方法は大きなデータセットには適していませんが、最も確実です。

---

### 方法2: 別のマシンまたはクラウド環境を使用

**別のマシンまたはクラウド環境（例：GitHub Actions、AWS EC2）を使用：**

- IPv6接続が正常に動作する環境を使用
- または、IPv4アドレスが取得できる環境を使用

**推奨環境：**
- GitHub Actions（無料、簡単にセットアップ可能）
- AWS EC2（有料、より柔軟）
- 別のWindows/Mac/Linuxマシン

---

### 方法3: ネットワーク設定を変更（上級者向け）

**ネットワーク設定を変更してIPv4アドレスを取得：**

1. **DNSサーバーを変更**（例: Google DNS `8.8.8.8`）
2. **IPv6を無効化**（一時的に）
3. **ネットワークアダプターの設定を変更**

**注意**: この方法はシステム設定を変更する必要があるため、慎重に実行してください。

---

## 📋 推奨手順

1. **Supabase DashboardのSQL Editorを使用**（小規模なデータの場合、最も確実）
2. **別のマシンまたはクラウド環境を使用**（大規模なデータの場合）
3. **ネットワーク設定を変更**（上級者向け、リスクあり）

---

## 🎯 次のステップ

**現在の環境では、DNS解決の問題により、`pg_restore`を使用したデータインポートが困難です。**

**推奨される次のステップ：**
1. **Supabase DashboardのSQL Editorを使用**
2. **または、別のマシン/クラウド環境を使用**

---

**まずは、Supabase DashboardのSQL Editorを使用することを強く推奨します！**

