# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã‚¬ã‚¤ãƒ‰

**æ›´æ–°æ—¥**: 2025å¹´1æœˆ  
**ç›®çš„**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œæ–¹æ³•ã‚’èª¬æ˜

---

## ğŸ¤– è‡ªå‹•åŒ–ã®çŠ¶æ³

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã¯ä¸»ã«è‡ªå‹•åŒ–ã•ã‚Œã¦ã„ã¾ã™**ã€‚

### âœ… è‡ªå‹•åŒ–ã•ã‚Œã¦ã„ã‚‹æ“ä½œ

1. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®é©ç”¨**
   - GitHub Actionsï¼ˆ`.github/workflows/apply-migrations.yml`ï¼‰ã§è‡ªå‹•å®Ÿè¡Œ
   - `supabase/migrations/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¦`main`ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒé©ç”¨ã•ã‚Œã¾ã™

2. **Prismaã‚¹ã‚­ãƒ¼ãƒã®æ›´æ–°**
   - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨å¾Œã€è‡ªå‹•çš„ã«`prisma db pull`ã¨`prisma generate`ãŒå®Ÿè¡Œã•ã‚Œã¾ã™

3. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¤œè¨¼**
   - ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«è‡ªå‹•çš„ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å®‰å…¨æ€§ã‚’ãƒã‚§ãƒƒã‚¯

---

## ğŸ‘¤ äººé–“ãŒè¡Œã†æ“ä½œ

### 1. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

**AIã¾ãŸã¯é–‹ç™ºè€…ãŒä½œæˆ**:
- `supabase/migrations/YYYYMMDD_HHMMSS_description.sql`å½¢å¼ã§SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
- ä¾‹: `supabase/migrations/20250116_120000_create_fee_rate_master.sql`

### 2. åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚ï¼ˆæ‰‹å‹•å®Ÿè¡ŒãŒå¿…è¦ãªå ´åˆï¼‰

**Supabase CLIã‚’ä½¿ç”¨**:
```bash
# Supabase CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install -g supabase

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãƒªãƒ³ã‚¯
supabase link --project-ref <project-ref>

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨
supabase db push
```

**ã¾ãŸã¯ã€npmã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨**:
```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨
npm run migrate supabase/migrations/20250116_120000_create_fee_rate_master.sql

# Prismaã‚¹ã‚­ãƒ¼ãƒã‚’æ›´æ–°
npm run migrate:prisma
```

### 3. æ‰‹å‹•ã§Supabase SQL Editorã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ

**é€šå¸¸ã¯ä¸è¦**ã§ã™ãŒã€ç·Šæ€¥æ™‚ã‚„ãƒ‡ãƒãƒƒã‚°æ™‚ã«ã¯æ‰‹å‹•ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ï¼š

1. Supabase Dashboardã«ã‚¢ã‚¯ã‚»ã‚¹
2. SQL Editorã‚’é–‹ã
3. SQLã‚’å®Ÿè¡Œ

**æ³¨æ„**: æ‰‹å‹•å®Ÿè¡Œã—ãŸå ´åˆã¯ã€Prismaã‚¹ã‚­ãƒ¼ãƒã‚’æ‰‹å‹•ã§æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
```bash
npx prisma db pull
npx prisma generate
```

---

## ğŸ”„ é€šå¸¸ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### æ–°ã—ã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹å ´åˆ

1. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ**
   ```bash
   # AIã¾ãŸã¯é–‹ç™ºè€…ãŒä½œæˆ
   # supabase/migrations/20250116_120000_create_fee_rate_master.sql
   ```

2. **Gitã«ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥**
   ```bash
   git add supabase/migrations/20250116_120000_create_fee_rate_master.sql
   git commit -m "feat: add fee_rate_master table"
   git push origin main
   ```

3. **è‡ªå‹•å®Ÿè¡Œ**
   - GitHub ActionsãŒè‡ªå‹•çš„ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨
   - Prismaã‚¹ã‚­ãƒ¼ãƒãŒè‡ªå‹•æ›´æ–°ã•ã‚Œã‚‹

**äººé–“ãŒæ‰‹å‹•ã§æ“ä½œã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“** âœ…

---

## ğŸš¨ ç·Šæ€¥æ™‚ã®æ‰‹å‹•æ“ä½œ

### æœ¬ç•ªç’°å¢ƒã§ç·Šæ€¥ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆ

1. **Supabase Dashboardã‹ã‚‰æ‰‹å‹•å®Ÿè¡Œ**
   - Supabase Dashboard â†’ SQL Editor
   - SQLã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆã—ã¦å®Ÿè¡Œ

2. **ã¾ãŸã¯ã€Supabase CLIã‹ã‚‰æ‰‹å‹•å®Ÿè¡Œ**
   ```bash
   supabase db push
   ```

3. **Prismaã‚¹ã‚­ãƒ¼ãƒã‚’æ‰‹å‹•æ›´æ–°**
   ```bash
   npx prisma db pull
   npx prisma generate
   ```

---

## ğŸ“‹ ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³

### ä»Šå›ä½œæˆã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

- **ãƒ•ã‚¡ã‚¤ãƒ«**: `supabase/migrations/20250116_120000_create_fee_rate_master.sql`
- **å†…å®¹**: æ‰‹æ•°æ–™ç‡ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **Gitã«ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥**
   ```bash
   git add supabase/migrations/20250116_120000_create_fee_rate_master.sql
   git commit -m "feat: add fee_rate_master table for fee rate management"
   git push origin main
   ```

2. **è‡ªå‹•å®Ÿè¡Œã‚’å¾…ã¤**
   - GitHub ActionsãŒè‡ªå‹•çš„ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨ã—ã¾ã™

3. **ã¾ãŸã¯ã€æ‰‹å‹•ã§å®Ÿè¡Œã™ã‚‹å ´åˆ**
   ```bash
   # Supabase CLIã‚’ä½¿ç”¨
   supabase db push
   
   # Prismaã‚¹ã‚­ãƒ¼ãƒã‚’æ›´æ–°
   npm run migrate:prisma
   ```

---

## ğŸ¯ ã¾ã¨ã‚

| æ“ä½œ | è‡ªå‹•åŒ– | æ‰‹å‹•æ“ä½œ |
|------|--------|---------|
| **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ** | âŒ | âœ… AIã¾ãŸã¯é–‹ç™ºè€… |
| **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®é©ç”¨** | âœ… GitHub Actions | âš ï¸ ç·Šæ€¥æ™‚ã®ã¿ |
| **Prismaã‚¹ã‚­ãƒ¼ãƒã®æ›´æ–°** | âœ… GitHub Actions | âš ï¸ ç·Šæ€¥æ™‚ã®ã¿ |
| **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¤œè¨¼** | âœ… GitHub Actions | - |

**çµè«–**: é€šå¸¸ã¯**äººé–“ãŒæ‰‹å‹•ã§æ“ä½œã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“**ã€‚GitHub ActionsãŒè‡ªå‹•çš„ã«å‡¦ç†ã—ã¾ã™ã€‚

ãŸã ã—ã€**åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚**ã‚„**ç·Šæ€¥æ™‚**ã«ã¯æ‰‹å‹•ã§æ“ä½œã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´1æœˆ

