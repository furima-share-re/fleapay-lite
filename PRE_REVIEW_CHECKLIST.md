# 実行計画レビュー前チェックリスト

他のAIにレビューを依頼する前に、Cursorで以下を確認してください。

---

## ✅ 必須チェック項目

### 1. 計画の完全性

- [ ] 全フェーズの手順が記載されている
- [ ] 各フェーズの開始条件が明確
- [ ] 各フェーズの完了条件が明確
- [ ] フェーズ間の依存関係が明記されている
- [ ] ロールバック手順が全フェーズで記載されている

### 2. 技術的詳細

- [ ] 使用する技術（TypeScript、Prisma、Supabase等）のバージョンが明記されている
- [ ] 環境変数の設定方法が記載されている
- [ ] データベース接続文字列の形式が記載されている
- [ ] コマンドラインコマンドが正確に記載されている
- [ ] SQL文が正確に記載されている

### 3. コードベースとの整合性

- [ ] 既存のコード構造を反映している
  - [ ] 既存のAPIエンドポイントが正しく記載されている
  - [ ] 既存のデータベーススキーマが正しく記載されている
  - [ ] 既存の認証方式が正しく記載されている
- [ ] 変更されるファイルのパスが正確
- [ ] 変更されないファイルが明確

### 4. 検証方法

- [ ] 各フェーズの動作確認方法が具体的
- [ ] パフォーマンス計測方法が記載されている
- [ ] データ整合性チェック方法が記載されている
- [ ] エラー時の対処方法が記載されている

### 5. リスク管理

- [ ] 各フェーズのリスクが識別されている
- [ ] リスクに対する対策が記載されている
- [ ] ロールバック基準が明確
- [ ] 緊急時の連絡先・手順が記載されている（該当する場合）

---

## 🔍 詳細チェック項目

### Phase 1.1: TypeScript導入

- [ ] `tsconfig.json`の設定内容が適切
- [ ] `allowJs: true`の設定が記載されている
- [ ] 既存JSファイルの扱いが明確

### Phase 1.2: Prisma導入

- [ ] Prismaスキーマの生成方法が記載されている
- [ ] 既存の`pg`直接使用との共存方法が明確
- [ ] 1つのエンドポイントのみ変更することが明確

### Phase 1.3: Supabase接続変更

- [ ] スキーマ移行手順が詳細
- [ ] エラー対処方法が記載されている
- [ ] 認証機能（bcryptjs）が維持されることが明確

### Phase 1.4: データ移行

- [ ] データバックアップ手順が記載されている
- [ ] データ移行手順が詳細（投入順序が明確）
- [ ] データ整合性チェック方法が具体的
- [ ] 外部キー制約の考慮が記載されている

### Phase 1.5: Supabase Auth移行（新規ユーザー）

- [ ] 新規ユーザーと既存ユーザーの区別が明確
- [ ] 共存状態の管理方法が記載されている
- [ ] Feature Flagの使用方法が明確

### Phase 1.6: 既存ユーザー移行

- [ ] 移行率の確認方法が記載されている
- [ ] パスワードリセット機能の実装方法が詳細
- [ ] 移行完了の定義が明確

### Phase 1.7: RLS実装

- [ ] RLSポリシーの内容が正確
- [ ] Service role keyの使用方法が明確
- [ ] 既存bcryptユーザーの扱いが明確

---

## 📝 レビュー依頼前の最終確認

- [ ] 上記のチェックリストをすべて確認済み
- [ ] 不明点や不足情報があれば、Cursorで補完済み
- [ ] 計画書のバージョンが最新（v1.3）
- [ ] 計画書の内容をコピーしてレビュー依頼文に貼り付け可能な状態

---

## 🚨 レビュー依頼前に修正すべき項目

以下の項目が不足している場合は、Cursorで補完してからレビュー依頼してください：

1. **技術バージョン**: TypeScript、Prisma、Supabase等のバージョン
2. **環境変数**: 具体的な環境変数名と値の例
3. **エラーハンドリング**: 想定されるエラーと対処方法
4. **パフォーマンス基準**: 具体的な数値目標（レスポンスタイム等）
5. **ロールバック時間**: 各フェーズのロールバック所要時間

---

## 📋 レビュー依頼手順

1. ✅ このチェックリストをすべて確認
2. 📄 `REVIEW_TEMPLATE_FOR_EXTERNAL_AI.md`を開く
3. 📋 レビュー依頼文をコピー
4. 📝 `MIGRATION_EXECUTION_PLAN.md`の内容を添付
5. 🤖 他のAI（Claude、GPT-4など）に送信
6. 📊 レビュー結果を`REVIEW_TEMPLATE_FOR_EXTERNAL_AI.md`のテンプレートに記録
7. 🔄 指摘事項を`MIGRATION_EXECUTION_PLAN.md`に反映

---

**最終確認**: このチェックリストをすべて完了してから、レビュー依頼を行ってください。

