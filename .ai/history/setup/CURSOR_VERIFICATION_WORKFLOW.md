# Cursor用: 動作確認ワークフロー

**作成日**: 2026-01-02  
**目的**: CursorのAIアシスタントが動作確認を行う際の標準ワークフロー

---

## 📋 動作確認前の必須チェック

動作確認を行う前に、**必ず**デプロイ状態を確認してください。

### チェック手順

1. **デプロイ状態確認スクリプトを実行**
   ```powershell
   .\scripts\auto-verify-staging.ps1
   ```

2. **結果に基づいて判断**
   - ✅ **デプロイ済み**: 動作確認を実行
   - ❌ **デプロイされていない**: デプロイを促すメッセージを表示して終了

---

## 🔄 標準ワークフロー

### Step 1: デプロイ状態確認

```powershell
.\scripts\auto-verify-staging.ps1
```

**期待される結果**:
- ローカルのコミットハッシュと検証環境のコミットハッシュが一致
- サーバーが正常に応答
- Prisma接続が正常

**デプロイされていない場合**:
- 警告メッセージを表示
- デプロイを促す
- 動作確認をスキップ（exit code 1）

### Step 2: 動作確認（デプロイ済みの場合のみ）

デプロイ状態確認が成功した場合のみ、動作確認を実行します。

**確認項目**:
1. ヘルスチェック (`/api/ping`)
2. APIエンドポイント（プラン別）
3. 画面表示（HTMLの存在確認）

---

## 📝 CursorのAIアシスタントへの指示例

### 基本的な指示

```
検証環境の動作確認を実行してください。
デプロイ状態を自動確認してから動作確認を行ってください。
```

### 詳細な指示

```
検証環境の動作確認を実行してください。

1. まず、デプロイ状態を確認してください
   - .\scripts\auto-verify-staging.ps1 を実行
   
2. デプロイされていない場合:
   - デプロイを促すメッセージを表示
   - 動作確認をスキップ
   
3. デプロイされている場合:
   - 動作確認を実行
   - 結果をレポートとして保存
```

---

## ✅ チェックリスト

動作確認を行う前に、以下を確認してください：

- [ ] デプロイ状態確認スクリプトを実行した
- [ ] ローカルのコミットハッシュと検証環境のコミットハッシュが一致している
- [ ] サーバーが正常に応答している
- [ ] Prisma接続が正常である

**すべての項目が確認できたら、動作確認を開始してください。**

---

## 🚨 トラブルシューティング

### 問題: デプロイ状態確認が失敗する

**対処**:
1. Render Dashboardでデプロイ状態を確認
2. 最新のコードをコミット・プッシュ
3. デプロイが完了するまで待機

### 問題: コミットハッシュが一致しない

**対処**:
1. 最新のコードがプッシュされているか確認
2. Render Dashboardで最新のデプロイを確認
3. 必要に応じて手動でデプロイをトリガー

---

## 📚 関連ドキュメント

- `scripts/auto-verify-staging.ps1` - 自動デプロイ状態確認 + 動作確認スクリプト
- `.ai/history/setup/CURSOR_AUTO_VERIFICATION_GUIDE.md` - Cursor用自動検証ガイド
- `.ai/history/setup/DEPLOYMENT_STATUS_CHECK_GUIDE.md` - デプロイ状態確認ガイド

---

**次回更新**: ワークフローの改善時

